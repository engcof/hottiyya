{% extends "base.html" %}
{% block title %}معرض الصور{% endblock %}
{% block content %}
<section class="all-page">
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">معرض الصور</h1>
            <p class="page">توثيق لحظات ومناسبات</p>
            {% if can_add %}
            <a href="/gallery/add" class="btn-f-action btn-f-view">
                <i class="fas fa-plus-circle ms-2"></i> إضافة صورة
            </a>
            {% endif %}
        </div>
        {% if success %}
        <div class="container mt-3">
            <div class="alert alert-success border-0 glass-strong text-center" role="alert" style="color: #2ecc71; background: rgba(46, 204, 113, 0.1);">
                <i class="fas fa-check-circle me-2"></i> {{ success }}
            </div>
        </div>
        {% endif %}
    

        <div class="d-flex justify-content-center mb-5 gap-3">
            <a href="/gallery/" class="btn-f-action {% if not selected_category %}btn-f-view{% else %}glass{% endif %}" style="text-decoration: none;">الكل</a>
            <a href="/gallery/?category=مناسبات" class="btn-f-action {% if selected_category == 'مناسبات' %}btn-f-view{% else %}glass{% endif %}" style="text-decoration: none;">مناسبات</a>
            <a href="/gallery/?category=تاريخي" class="btn-f-action {% if selected_category == 'تاريخي' %}btn-f-view{% else %}glass{% endif %}" style="text-decoration: none;">تاريخي</a>
        </div>

        <div class="gallery-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;">
            {% for image in images %}
            <div class="glass-strong gallery-item" style="padding: 15px; transition: var(--transition); position: relative;">
            
                {% if can_delete %}
                    <form action="/gallery/delete/{{ image.id }}" method="POST" onsubmit="return confirm('هل أنت متأكد من الحذف؟')" >
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <button type="submit" class="btn-delete-small">حذف</button>
                    </form>
                {% endif %}

                <div onclick="openModal('{{ image.image_url }}', '{{ image.title }}')" style="cursor: pointer;">
                    <div style="width: 100%; height: 220px; overflow: hidden; border-radius: 12px; margin-bottom: 15px;">
                        <img src="{{ image.image_url }}" alt="{{ image.title }}" 
                            style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease;" 
                            class="gallery-img" loading="lazy">
                    </div>
                    <div class="text-center">
                        <h3 style="font-size: 1.1rem; font-weight: 700; color: var(--text); margin-bottom: 8px;">{{ image.title }}</h3>
                        {% if image.category %}
                        <span class="nickname-badge" style="font-size: 0.75rem;">{{ image.category }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% else %}
            <div style="grid-column: 1 / -1; text-align: center; padding: 100px 0;">
                <p class="text-lighter">لا توجد صور في هذا القسم حالياً.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}